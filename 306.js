"use strict";(self.webpackChunkdiscover_extension=self.webpackChunkdiscover_extension||[]).push([[306],{33306(e,a,t){t.d(a,{ReactNativeKeychainStamper:()=>c});var r=t(88942),i=t(13631);let s;try{s=require("react-native-keychain")}catch{throw new Error("Please install react-native-keychain in your app to use ReactNativeKeychainStamper")}class c{async listKeyPairs(){return await s.getAllGenericPasswordServices()}async clearKeyPairs(){const e=await this.listKeyPairs();for(const a of e)await this.deleteKeyPair(a)}async createKeyPair(e){let a,t;if(e)a=e.privateKey,t=e.publicKey;else{const e=(0,i.CD)();a=e.privateKey,t=e.publicKey}return await s.setGenericPassword(t,a,{service:t}),t}async deleteKeyPair(e){await s.resetGenericPassword({service:e})}async getPrivateKey(e){const a=await s.getGenericPassword({service:e});return a?a.password:null}async stamp(e,a){const t=await this.getPrivateKey(a);if(!t)throw new Error(`No private key found for public key: ${a}`);const i=new r.E6({apiPublicKey:a,apiPrivateKey:t}),{stampHeaderName:s,stampHeaderValue:c}=await i.stamp(e);return{stampHeaderName:s,stampHeaderValue:c}}}}}]);